<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>c2ephp: agents/PRAY/AGNTBlock.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>agents/PRAY/AGNTBlock.php</h1>  </div>
</div>
<div class="contents">
<a href="AGNTBlock_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 require_once(dirname(__FILE__).<span class="stringliteral">&#39;/../../sprites/C16File.php&#39;</span>);
<a name="l00003"></a>00003 require_once(dirname(__FILE__).<span class="stringliteral">&#39;/../../sprites/S16File.php&#39;</span>);
<a name="l00004"></a>00004 require_once(dirname(__FILE__).<span class="stringliteral">&#39;/TagBlock.php&#39;</span>);
<a name="l00005"></a>00005 
<a name="l00007"></a><a class="code" href="classAGNTBlock.html">00007</a> <span class="keyword">class </span><a class="code" href="classAGNTBlock.html" title="Represents an AGNT block in a PRAY file, used for C3 Agent scripts and metadata.">AGNTBlock</a> <span class="keyword">extends</span> <a class="code" href="classTagBlock.html" title="Base block class for working with tag-type blocks.">TagBlock</a> {
<a name="l00008"></a>00008   
<a name="l00010"></a>00010 
<a name="l00021"></a><a class="code" href="classAGNTBlock.html#acee06bf09393456bdd4fc7d982bec274">00021</a>     <span class="keyword">public</span> function <a class="code" href="classAGNTBlock.html#acee06bf09393456bdd4fc7d982bec274" title="Instantiate a new AGNTBlock.">AGNTBlock</a>(<a class="code" href="pray-frankenstein_8php.html#a8db1a2e2bee6226a8d70fc25ffa2f5eb">$prayfile</a>,$name,$content,$flags) {
<a name="l00022"></a>00022         parent::TagBlock(<a class="code" href="pray-frankenstein_8php.html#a8db1a2e2bee6226a8d70fc25ffa2f5eb">$prayfile</a>,$name,$content,$flags,<a class="code" href="classPrayBlock.html#ae6b8d09662a25c2a767be835a21d3730">PRAY_BLOCK_AGNT</a>);
<a name="l00023"></a>00023     }
<a name="l00024"></a>00024 
<a name="l00026"></a>00026 
<a name="l00031"></a><a class="code" href="classAGNTBlock.html#a8720772125ca2c8d25ce7c8bff50941b">00031</a>     <span class="keyword">public</span> function <a class="code" href="classAGNTBlock.html#a8720772125ca2c8d25ce7c8bff50941b" title="Gets the agent&amp;#39;s name.">GetAgentName</a>() {
<a name="l00032"></a>00032         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPrayBlock.html#ae402d243b322e2702906a746c90df6e3" title="Gets the PRAY block&amp;#39;s name.">GetName</a>();
<a name="l00033"></a>00033     }
<a name="l00035"></a>00035 
<a name="l00039"></a><a class="code" href="classAGNTBlock.html#a9c95007cd479e2571471555dbec89ce6">00039</a>     <span class="keyword">public</span> function <a class="code" href="classAGNTBlock.html#a9c95007cd479e2571471555dbec89ce6" title="Gets the agent&amp;#39;s description in the specified language.">GetAgentDescription</a>($localisation=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l00040"></a>00040         <span class="keywordflow">if</span>($localisation == <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00041"></a>00041             <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTagBlock.html#a545c136659362f531ebf88aacb6fe2c5" title="Gets the tag with the given name.">GetTag</a>(<span class="stringliteral">&#39;Agent Description&#39;</span>);
<a name="l00042"></a>00042         } <span class="keywordflow">else</span> {
<a name="l00043"></a>00043             $description = $this-&gt;<a class="code" href="classTagBlock.html#a545c136659362f531ebf88aacb6fe2c5" title="Gets the tag with the given name.">GetTag</a>(<span class="stringliteral">&#39;Agent Description-&#39;</span>.$localisation);
<a name="l00044"></a>00044             <span class="keywordflow">if</span>($description == <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00045"></a>00045                 $description = $this-&gt;<a class="code" href="classTagBlock.html#a545c136659362f531ebf88aacb6fe2c5" title="Gets the tag with the given name.">GetTag</a>(<span class="stringliteral">&#39;Agent Description&#39;</span>); 
<a name="l00046"></a>00046             }
<a name="l00047"></a>00047             <span class="keywordflow">return</span> $description;
<a name="l00048"></a>00048         }
<a name="l00049"></a>00049     }
<a name="l00051"></a>00051 
<a name="l00054"></a><a class="code" href="classAGNTBlock.html#a21d55e722fc1025e3ad671d05f4a0c56">00054</a>     <span class="keyword">public</span> function <a class="code" href="classAGNTBlock.html#a21d55e722fc1025e3ad671d05f4a0c56" title="Gets the agent&amp;#39;s type.">GetAgentType</a>() {
<a name="l00055"></a>00055         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTagBlock.html#a545c136659362f531ebf88aacb6fe2c5" title="Gets the tag with the given name.">GetTag</a>(<span class="stringliteral">&#39;Agent Type&#39;</span>);
<a name="l00056"></a>00056     }
<a name="l00058"></a><a class="code" href="classAGNTBlock.html#ac9702baa18c161d9381e0843d8449bfd">00058</a>     <span class="keyword">public</span> function <a class="code" href="classAGNTBlock.html#ac9702baa18c161d9381e0843d8449bfd" title="Gets the number of scripts stored in this block.">GetScriptCount</a>() {
<a name="l00059"></a>00059         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTagBlock.html#a545c136659362f531ebf88aacb6fe2c5" title="Gets the tag with the given name.">GetTag</a>(<span class="stringliteral">&#39;Script Count&#39;</span>);
<a name="l00060"></a>00060     }
<a name="l00062"></a>00062 
<a name="l00066"></a><a class="code" href="classAGNTBlock.html#a05e28543e14644adbc643580800bfc67">00066</a>     <span class="keyword">public</span> function <a class="code" href="classAGNTBlock.html#a05e28543e14644adbc643580800bfc67" title="Gets the specified script.">GetScript</a>($script=1) {
<a name="l00067"></a>00067         <span class="keywordflow">if</span>($script &gt; 0 &amp;&amp; $script &lt;= $this-&gt;<a class="code" href="classAGNTBlock.html#ac9702baa18c161d9381e0843d8449bfd" title="Gets the number of scripts stored in this block.">GetScriptCount</a>()) {
<a name="l00068"></a>00068             <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTagBlock.html#a545c136659362f531ebf88aacb6fe2c5" title="Gets the tag with the given name.">GetTag</a>(<span class="stringliteral">&#39;Script &#39;</span>.$script);            
<a name="l00069"></a>00069         }
<a name="l00070"></a>00070         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Script doesn\&#39;t exist!&#39;</span>);
<a name="l00071"></a>00071         
<a name="l00072"></a>00072     }
<a name="l00074"></a><a class="code" href="classAGNTBlock.html#adfe8bc1dcd848aac76c66467b6021034">00074</a>     <span class="keyword">public</span> function <a class="code" href="classAGNTBlock.html#adfe8bc1dcd848aac76c66467b6021034" title="Get the number of files this agent depends on.">GetDependencyCount</a>() {
<a name="l00075"></a>00075         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTagBlock.html#a545c136659362f531ebf88aacb6fe2c5" title="Gets the tag with the given name.">GetTag</a>(<span class="stringliteral">&#39;Dependency Count&#39;</span>);
<a name="l00076"></a>00076     }
<a name="l00078"></a>00078 
<a name="l00082"></a><a class="code" href="classAGNTBlock.html#a5d89979cfa2e3910506aacdc55840e6b">00082</a>     <span class="keyword">public</span> function <a class="code" href="classAGNTBlock.html#a5d89979cfa2e3910506aacdc55840e6b" title="Gets the dependency specified.">GetDependency</a>($dependency) {
<a name="l00083"></a>00083         <a class="code" href="sprite-extract_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a> = $this-&gt;<a class="code" href="classTagBlock.html#a545c136659362f531ebf88aacb6fe2c5" title="Gets the tag with the given name.">GetTag</a>(<span class="stringliteral">&#39;Dependency &#39;</span>.$dependency);
<a name="l00084"></a>00084         $category = $this-&gt;<a class="code" href="classTagBlock.html#a545c136659362f531ebf88aacb6fe2c5" title="Gets the tag with the given name.">GetTag</a>(<span class="stringliteral">&#39;Dependency Category &#39;</span>.$dependency);
<a name="l00085"></a>00085         <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classPrayDependency.html" title="Dependency class used in various PrayBlocks.">PrayDependency</a>($category,<a class="code" href="sprite-extract_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l00086"></a>00086     }
<a name="l00088"></a>00088 
<a name="l00090"></a><a class="code" href="classAGNTBlock.html#a538795b097cb5b4f19124fde50ddaa87">00090</a>     <span class="keyword">public</span> function <a class="code" href="classAGNTBlock.html#a538795b097cb5b4f19124fde50ddaa87" title="Gets all the files this agent depends on.">GetDependencies</a>() {
<a name="l00091"></a>00091         $dependencies = array();
<a name="l00092"></a>00092         <span class="keywordflow">for</span>($i = 1; $i &lt;= $this-&gt;<a class="code" href="classAGNTBlock.html#adfe8bc1dcd848aac76c66467b6021034" title="Get the number of files this agent depends on.">GetDependencyCount</a>(); $i++) {
<a name="l00093"></a>00093             $dependencies[] = $this-&gt;<a class="code" href="classAGNTBlock.html#a5d89979cfa2e3910506aacdc55840e6b" title="Gets the dependency specified.">GetDependency</a>($i);
<a name="l00094"></a>00094         }
<a name="l00095"></a>00095         <span class="keywordflow">return</span> $dependencies;
<a name="l00096"></a>00096     }
<a name="l00098"></a>00098 
<a name="l00102"></a><a class="code" href="classAGNTBlock.html#aef464bdeb6b1db7c0f8938317f79db41">00102</a>     <span class="keyword">public</span> function <a class="code" href="classAGNTBlock.html#aef464bdeb6b1db7c0f8938317f79db41" title="Gets the script used to remove this agent.">GetRemoveScript</a>() {
<a name="l00103"></a>00103         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTagBlock.html#a545c136659362f531ebf88aacb6fe2c5" title="Gets the tag with the given name.">GetTag</a>(<span class="stringliteral">&#39;Remove Script&#39;</span>);
<a name="l00104"></a>00104     }
<a name="l00106"></a>00106 
<a name="l00109"></a><a class="code" href="classAGNTBlock.html#a9c02d6881b7eaafed281535f8e657993">00109</a>     <span class="keyword">public</span> function <a class="code" href="classAGNTBlock.html#a9c02d6881b7eaafed281535f8e657993" title="Gets the file used for the animation of the agent on the C3 Creator/DS injector.">GetAgentAnimationFile</a>() {
<a name="l00110"></a>00110         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTagBlock.html#a545c136659362f531ebf88aacb6fe2c5" title="Gets the tag with the given name.">GetTag</a>(<span class="stringliteral">&#39;Agent Animation File&#39;</span>);
<a name="l00111"></a>00111     }
<a name="l00114"></a>00114 
<a name="l00119"></a><a class="code" href="classAGNTBlock.html#abe12dc5b0e7fb3812d13406fb61d8082">00119</a>     <span class="keyword">public</span> function <a class="code" href="classAGNTBlock.html#abe12dc5b0e7fb3812d13406fb61d8082" title="Gets the filename (excluding extension) used for the animation of the agent on the C3 Creator/DS inje...">GetAgentAnimationGallery</a>() {
<a name="l00120"></a>00120         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTagBlock.html#a545c136659362f531ebf88aacb6fe2c5" title="Gets the tag with the given name.">GetTag</a>(<span class="stringliteral">&#39;Agent Animation Gallery&#39;</span>);
<a name="l00121"></a>00121     }
<a name="l00124"></a>00124 
<a name="l00132"></a><a class="code" href="classAGNTBlock.html#ab8ee85b3bc08b92c7dbbf14dba21797a">00132</a>     <span class="keyword">public</span> function <a class="code" href="classAGNTBlock.html#ab8ee85b3bc08b92c7dbbf14dba21797a" title="Gets the number of the first image of the animation displayed on the C3 Creator/DS injector...">GetAgentAnimationFirstImage</a>() {
<a name="l00133"></a>00133         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTagBlock.html#a545c136659362f531ebf88aacb6fe2c5" title="Gets the tag with the given name.">GetTag</a>(<span class="stringliteral">&#39;Animation Sprite First Image&#39;</span>);
<a name="l00134"></a>00134     }
<a name="l00136"></a>00136 
<a name="l00139"></a><a class="code" href="classAGNTBlock.html#a64ce5fdebfdc341d7d3f10d24325e491">00139</a>     <span class="keyword">public</span> function <a class="code" href="classAGNTBlock.html#a64ce5fdebfdc341d7d3f10d24325e491" title="Gets the animation displayed on the C3 creator/DS injector.">GetAgentAnimationString</a>() {
<a name="l00140"></a>00140         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTagBlock.html#a545c136659362f531ebf88aacb6fe2c5" title="Gets the tag with the given name.">GetTag</a>(<span class="stringliteral">&#39;Agent Animation String&#39;</span>);
<a name="l00141"></a>00141     }
<a name="l00143"></a>00143 
<a name="l00154"></a><a class="code" href="classAGNTBlock.html#a3a1d68436877f172fc5892bff2ea258d">00154</a>     <span class="keyword">public</span> function <a class="code" href="classAGNTBlock.html#a3a1d68436877f172fc5892bff2ea258d" title="Gets the image used on the creator.">GetAgentAnimationAsSpriteFrame</a>() {
<a name="l00155"></a>00155         $animationFile = $this-&gt;<a class="code" href="classAGNTBlock.html#a9c02d6881b7eaafed281535f8e657993" title="Gets the file used for the animation of the agent on the C3 Creator/DS injector.">GetAgentAnimationFile</a>();
<a name="l00156"></a>00156         <span class="keywordflow">if</span>($animationFile == <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00157"></a>00157             $animationFile = $this-&gt;<a class="code" href="classAGNTBlock.html#abe12dc5b0e7fb3812d13406fb61d8082" title="Gets the filename (excluding extension) used for the animation of the agent on the C3 Creator/DS inje...">GetAgentAnimationGallery</a>();
<a name="l00158"></a>00158             <span class="keywordflow">if</span>($animationFile == <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00159"></a>00159                 <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;No animation file!&#39;</span>);
<a name="l00160"></a>00160             }
<a name="l00161"></a>00161             $animationFile .= <span class="stringliteral">&#39;.c16&#39;</span>;
<a name="l00162"></a>00162         }
<a name="l00163"></a>00163         $animationFirstImage = $this-&gt;<a class="code" href="classAGNTBlock.html#ab8ee85b3bc08b92c7dbbf14dba21797a" title="Gets the number of the first image of the animation displayed on the C3 Creator/DS injector...">GetAgentAnimationFirstImage</a>();
<a name="l00164"></a>00164         $animationString = $this-&gt;<a class="code" href="classAGNTBlock.html#a64ce5fdebfdc341d7d3f10d24325e491" title="Gets the animation displayed on the C3 creator/DS injector.">GetAgentAnimationString</a>();
<a name="l00165"></a>00165         <span class="keywordflow">if</span>($animationFirstImage == <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00166"></a>00166             $animationFirstImage = 0;
<a name="l00167"></a>00167         }
<a name="l00168"></a>00168         <span class="keywordflow">if</span>($animationString == <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00169"></a>00169             $animationString = 0;
<a name="l00170"></a>00170         }
<a name="l00171"></a>00171         <span class="keywordflow">if</span>(($position = strpos($animationString,<span class="charliteral">&#39; &#39;</span>)) !== <span class="keyword">false</span>) {
<a name="l00172"></a>00172             $animationString = substr($animationString,0,$position);
<a name="l00173"></a>00173         }
<a name="l00174"></a>00174         <a class="code" href="pray-frankenstein_8php.html#a8db1a2e2bee6226a8d70fc25ffa2f5eb">$prayfile</a> = $this-&gt;GetPrayFile();
<a name="l00175"></a>00175         <span class="keywordflow">if</span>(<a class="code" href="pray-frankenstein_8php.html#a8db1a2e2bee6226a8d70fc25ffa2f5eb">$prayfile</a> == null) {
<a name="l00176"></a>00176             <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;No PRAY file to get the icon from!&#39;</span>);
<a name="l00177"></a>00177         }
<a name="l00178"></a>00178         $iconBlock = <a class="code" href="pray-frankenstein_8php.html#a8db1a2e2bee6226a8d70fc25ffa2f5eb">$prayfile</a>-&gt;GetBlockByName($animationFile);
<a name="l00179"></a>00179         <span class="keywordflow">if</span>($iconBlock-&gt;GetType() != <span class="stringliteral">&#39;FILE&#39;</span>) {
<a name="l00180"></a>00180             <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;The block with the animation\&#39;s filename is not a file block!&#39;</span>);
<a name="l00181"></a>00181         }
<a name="l00182"></a>00182         $type = strtolower(substr($animationFile,-3));
<a name="l00183"></a>00183         $icon = null;
<a name="l00184"></a>00184         print $type;
<a name="l00185"></a>00185         <span class="keywordflow">if</span>($type == <span class="stringliteral">&#39;c16&#39;</span>) {
<a name="l00186"></a>00186             $icon = <span class="keyword">new</span> <a class="code" href="classC16File.html" title="Class representing a C16 sprite file.">C16File</a>(<span class="keyword">new</span> <a class="code" href="classStringReader.html">StringReader</a>($iconBlock-&gt;GetData()));
<a name="l00187"></a>00187         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>($type == <span class="stringliteral">&#39;s16&#39;</span>) {
<a name="l00188"></a>00188             $icon = <span class="keyword">new</span> <a class="code" href="classS16File.html" title="Class for S16 sprite files.">S16File</a>(<span class="keyword">new</span> <a class="code" href="classStringReader.html">StringReader</a>($iconBlock-&gt;GetData()));
<a name="l00189"></a>00189         }
<a name="l00190"></a>00190         <span class="keywordflow">if</span>($icon == null) {
<a name="l00191"></a>00191             <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;For one reason or another, couldn\&#39;t make a sprite file for the agent.&#39;</span>);
<a name="l00192"></a>00192         }
<a name="l00193"></a>00193         <span class="keywordflow">return</span> $icon-&gt;GetFrame($animationFirstImage+$animationString);
<a name="l00194"></a>00194     }
<a name="l00195"></a>00195 }
<a name="l00196"></a>00196 ?&gt;
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 1 2011 02:00:13 for c2ephp by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
